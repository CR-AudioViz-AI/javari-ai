/* app/globals.css */
/* 2026-02-20 — STEP 0: Added dvh/safe-area utilities */
/* All existing tokens preserved — only additions made */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ── iOS / Mobile viewport fix ──────────────────────────────────────────────
   Provides --app-height fallback chain for browsers that don't support dvh.
   Set by JS on load and on resize. Components use var(--app-height, 100dvh).
   ────────────────────────────────────────────────────────────────────────── */
@layer base {
  :root {
    --app-height: 100dvh;
  }

  html, body {
    /* Prevent iOS scroll bounce from leaking outside app */
    overscroll-behavior: none;
    /* Respect safe areas on notched devices */
    padding-top: env(safe-area-inset-top, 0px);
    padding-left: env(safe-area-inset-left, 0px);
    padding-right: env(safe-area-inset-right, 0px);
  }
}

/* ── Safe area utility classes ──────────────────────────────────────────────*/
@layer utilities {
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom, 0px);
  }
  .pt-safe {
    padding-top: env(safe-area-inset-top, 0px);
  }
  .h-screen-safe {
    height: 100dvh;
    height: var(--app-height, 100vh);
  }
  .min-h-screen-safe {
    min-height: 100dvh;
    min-height: var(--app-height, 100vh);
  }
}

/* === JAVARI AVATAR ANIMATIONS === */

@keyframes avatarIdle {
  0% { box-shadow: 0 0 10px #4fa0ff40; }
  50% { box-shadow: 0 0 16px #4fa0ff70; }
  100% { box-shadow: 0 0 10px #4fa0ff40; }
}

@keyframes avatarListening {
  0% { box-shadow: 0 0 20px #4fd1ff; }
  50% { box-shadow: 0 0 35px #7fe7ff; }
  100% { box-shadow: 0 0 20px #4fd1ff; }
}

@keyframes avatarThinking {
  0% { box-shadow: 0 0 20px #7f5cff; }
  50% { box-shadow: 0 0 35px #a68cff; transform: scale(1.015); }
  100% { box-shadow: 0 0 20px #7f5cff; }
}

@keyframes avatarSpeaking {
  0% { box-shadow: 0 0 18px #4cff7a; }
  50% { box-shadow: 0 0 40px #7cff9b; transform: scale(1.02); }
  100% { box-shadow: 0 0 18px #4cff7a; }
}

@keyframes avatarError {
  0% { box-shadow: 0 0 20px #ff4d4d; }
  50% { box-shadow: 0 0 40px #ff8080; }
  100% { box-shadow: 0 0 20px #ff4d4d; }
}

.animate-avatarIdle { animation: avatarIdle 4s ease-in-out infinite; }
.animate-avatarListening { animation: avatarListening 1.2s ease-in-out infinite; }
.animate-avatarThinking { animation: avatarThinking 2.5s ease-in-out infinite; }
.animate-avatarSpeaking { animation: avatarSpeaking 1.2s ease-in-out infinite; }
.animate-avatarError { animation: avatarError 0.8s ease-in-out infinite; }

/* ============================================
   DESIGN TOKENS — LIGHT MODE (Default)
   ============================================ */

:root {
  /* === Semantic Colors === */
  /* Background & Surface */
  --background: 0 0% 100%;           /* Pure white */
  --foreground: 222 47% 11%;         /* Near black text - WCAG AA */
  --surface: 0 0% 98%;               /* Light gray surface */
  --surface-muted: 210 40% 96%;      /* Muted surface */
  
  /* Primary Brand */
  --primary: 221 83% 53%;            /* Vibrant blue */
  --primary-foreground: 0 0% 100%;   /* White text on primary */
  
  /* Secondary */
  --secondary: 210 40% 96%;          /* Light blue-gray */
  --secondary-foreground: 222 47% 11%; /* Dark text on secondary */
  
  /* Accent */
  --accent: 142 76% 36%;             /* Green accent */
  --accent-foreground: 0 0% 100%;    /* White text on accent */
  
  /* Semantic States */
  --success: 142 76% 36%;            /* Green */
  --warning: 38 92% 50%;             /* Amber */
  --error: 0 84% 60%;                /* Red */
  
  /* Borders & Focus */
  --border: 214 32% 91%;             /* Light border */
  --focus-ring: 221 83% 53%;         /* Blue focus ring */
  
  /* Text Hierarchy */
  --text-primary: 222 47% 11%;       /* Primary text */
  --text-secondary: 215 25% 35%;     /* Secondary text */
  --text-muted: 215 16% 47%;         /* Muted text */
  --text-disabled: 220 9% 71%;       /* Disabled text */
  
  /* === Typography Scale === */
  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
  
  --text-xs: 0.75rem;      /* 12px */
  --text-sm: 0.875rem;     /* 14px */
  --text-base: 1rem;       /* 16px */
  --text-lg: 1.125rem;     /* 18px */
  --text-xl: 1.25rem;      /* 20px */
  --text-2xl: 1.5rem;      /* 24px */
  --text-3xl: 1.875rem;    /* 30px */
  --text-4xl: 2.25rem;     /* 36px */
  
  --leading-tight: 1.25;
  --leading-normal: 1.5;
  --leading-relaxed: 1.625;
  
  /* === Spacing Scale (rem) === */
  --space-0: 0;
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;
  --space-8: 2rem;
  --space-10: 2.5rem;
  --space-12: 3rem;
  --space-16: 4rem;
  
  /* === Border Radius === */
  --radius-sm: 0.25rem;
  --radius-md: 0.375rem;
  --radius-lg: 0.5rem;
  --radius-xl: 0.75rem;
  --radius-2xl: 1rem;
  --radius-full: 9999px;
  
  /* === Elevation (Shadows) === */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
  
  /* === Motion Tokens === */
  --duration-fast: 150ms;
  --duration-normal: 200ms;
  --duration-slow: 300ms;
  --ease-default: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-in: cubic-bezier(0.4, 0, 1, 1);
  --ease-out: cubic-bezier(0, 0, 0.2, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ============================================
   DARK MODE (via data-theme="dark")
   ============================================ */

[data-theme="dark"] {
  --background: 222 47% 7%;
  --foreground: 210 40% 96%;
  --surface: 222 47% 11%;
  --surface-muted: 217 33% 17%;
  
  --primary: 217 91% 60%;
  --primary-foreground: 0 0% 100%;
  
  --secondary: 217 33% 17%;
  --secondary-foreground: 210 40% 96%;
  
  --border: 217 33% 20%;
  
  --text-primary: 210 40% 96%;
  --text-secondary: 215 20% 65%;
  --text-muted: 215 16% 47%;
  --text-disabled: 215 16% 35%;
}

/* ============================================
   REDUCED MOTION — respect user preference
   ============================================ */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  .animate-avatarIdle,
  .animate-avatarListening,
  .animate-avatarThinking,
  .animate-avatarSpeaking,
  .animate-avatarError {
    animation: none !important;
  }
}
